(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20c934ab"],{"068d":function(e,t,a){t=e.exports=a("2350")(!1),t.push([e.i,'#ctable .el-dialog{margin-top:5vh!important}#ctable .render_label p{margin:0}#ctable .cell{text-align:center}#ctable table{width:100%!important}#ctable .el-table th{display:table-cell!important}#ctable .el-date-editor.el-input,#ctable .el-date-editor.el-input__inner{width:100%}#ctable .el-icon-time:before{content:""}#ctable .el-table colgroup{display:table-cell!important}#ctable .el-table--enable-row-hover .el-table__body tr:hover>td{background-color:inherit!important}#ctable .el-table--border td:first-child .cell,#ctable .el-table--border th:first-child .cell,#ctable .el-table .cell,#ctable .el-table th div{padding-left:3px!important}#ctable .el-table .cell,#ctable .el-table th div{padding-right:3px!important}#ctable .el-form--inline .el-form-item{display:inline-block;vertical-align:top;display:-webkit-box;display:-ms-flexbox;display:flex;margin-right:0}#ctable .el-form--inline .el-form-item__label{width:90px;-moz-text-align-last:justify;text-align-last:justify}#ctable .el-form-item__content{-webkit-box-flex:1;-ms-flex:1;flex:1}#ctable .el-select{width:100%}#ctable .el-dialog__footer{text-align:center}#ctable .el-button--primary{width:auto!important}#ctable .el-dialog__header{text-align:center}#ctable .el-dialog__body{padding:0 15px}#ctable .wper100{width:100%!important}',""]),t.locals={trOddColor:"#c3cdd6",trEvenColor:"#ead0b3"}},"9eff":function(e,t,a){"use strict";var i=a("e247"),r=a.n(i);r.a},bd0b:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"wechat-title",rawName:"v-wechat-title",value:e.$route.meta.title,expression:"$route.meta.title"}],staticStyle:{width:"100%"},attrs:{id:"ctable"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",size:"small","span-method":e.arraySpanMethod,"row-style":e.changeCss,"header-cell-class-name":"headerStyle "}},[a("el-table-column",{attrs:{prop:"district",label:"区域"}}),a("el-table-column",{attrs:{prop:"carType",label:"车型"}}),a("el-table-column",{attrs:{prop:"carNo",label:"车牌号"}}),a("el-table-column",{attrs:{prop:"loadWeight",label:"载重,(吨)","render-header":e.renderHeader}}),a("el-table-column",{attrs:{prop:"limitTip",label:"期限"},scopedSlots:e._u([{key:"default",fn:function(t){return["已到期"==t.row.limitTip?a("span",{staticStyle:{color:"gray"}},[e._v("\n            "+e._s(t.row.limitTip)+"\n        ")]):"未到期"==t.row.limitTip?a("span",[e._v("\n            "+e._s(t.row.limitTip)+"\n        ")]):a("span",{staticStyle:{color:"#F56C6C"}},[e._v("\n            "+e._s(t.row.limitTip)+"\n        ")])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"100px",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{staticClass:"mr10 font-12",attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.openUpdateDialog(t.row)}}},[e._v("编辑")]),a("el-link",{staticClass:"font-12",attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.deleteCar(t.row)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"p15"},[a("el-button",{staticClass:"mt15 wper100",attrs:{type:"primary"},on:{click:e.openAddDialog}},[e._v("添加")])],1),a("el-dialog",{attrs:{title:e.title+"车信息",visible:e.isVisible,width:"80%","show-close":!1}},[a("el-form",{ref:"form",attrs:{model:e.form,inline:!0,rules:e.rules}},[a("el-form-item",{attrs:{label:"区域:",prop:"district"}},[a("el-input",{attrs:{type:"text",autocomplete:"off",placeholder:"请输入区域"},model:{value:e.form.district,callback:function(t){e.$set(e.form,"district",t)},expression:"form.district"}})],1),a("el-form-item",{attrs:{label:"车型:",prop:"carType"}},[a("el-input",{attrs:{type:"text",autocomplete:"off",placeholder:"请输入车型"},model:{value:e.form.carType,callback:function(t){e.$set(e.form,"carType",t)},expression:"form.carType"}})],1),a("el-form-item",{attrs:{label:"车牌号:",prop:"carNo"}},[a("el-input",{attrs:{type:"text",autocomplete:"off",placeholder:"请输入车牌号"},model:{value:e.form.carNo,callback:function(t){e.$set(e.form,"carNo",t)},expression:"form.carNo"}})],1),a("el-form-item",{attrs:{label:"载重:",prop:"loadWeight"}},[a("el-input",{attrs:{type:"text",autocomplete:"off",placeholder:"请输入载重(单位吨)"},model:{value:e.form.loadWeight,callback:function(t){e.$set(e.form,"loadWeight",t)},expression:"form.loadWeight"}})],1),a("el-form-item",{attrs:{label:"介质:",prop:"media"}},[a("el-select",{attrs:{placeholder:"请选择介质"},model:{value:e.form.media,callback:function(t){e.$set(e.form,"media",t)},expression:"form.media"}},e._l(e.mediaList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"电话:",prop:"tel"}},[a("el-input",{attrs:{type:"number",autocomplete:"off",placeholder:"请输入联系电话"},model:{value:e.form.tel,callback:function(t){e.$set(e.form,"tel",t)},expression:"form.tel"}})],1),a("el-form-item",{attrs:{label:"开始时间:",prop:"startTime"}},[a("el-input",{attrs:{autocomplete:"off",readonly:"",placeholder:"请点击选择日期"},on:{focus:function(t){return e.showPopFn()}},model:{value:e.form.startTime,callback:function(t){e.$set(e.form,"startTime",t)},expression:"form.startTime"}}),a("van-popup",{style:{height:"40%"},attrs:{position:"bottom"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[a("van-datetime-picker",{attrs:{type:"datetime"},on:{change:function(t){return e.changeFn()},confirm:function(t){return e.confirmFn()},cancel:function(t){return e.cancelFn()}},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}})],1)],1),a("el-form-item",{attrs:{label:"期限:",prop:"limitDays"}},[a("el-select",{attrs:{placeholder:"请选择期限"},model:{value:e.form.limitDays,callback:function(t){e.$set(e.form,"limitDays",t)},expression:"form.limitDays"}},e._l(e.limitDaysList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"图片:",prop:"picture"}},[a("van-uploader",{attrs:{"max-size":e.size,"after-read":e.afterRead,"max-count":1,"before-read":e.beforeRead},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.controlCar}},[e._v(e._s(e.title))]),a("el-button",{on:{click:e.toggleDialog}},[e._v("关闭")])],1)],1),a("div",{staticClass:"van-toast van-toast--middle van-toast--loading",style:{display:e.isShowLoading}},[e._m(0),a("div",{staticClass:"van-toast__text"},[e._v("\n        "+e._s(e.messsage)+"\n      ")])])],1)},r=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"van-loading van-loading--spinner van-toast__loading"},[a("span",{staticClass:"van-loading__spinner van-loading__spinner--spinner"},[a("i"),a("i"),a("i"),a("i"),a("i"),a("i"),a("i"),a("i"),a("i"),a("i"),a("i"),a("i")])])}],l=(a("28a5"),a("ac6a"),a("6762"),a("2fdb"),a("7f7f"),a("eeb9")),o=a("bbd5"),s=a("8c1f"),n=a.n(s),c={data:function(){var e=function(e,t,a){var i=/^\d{11}$/;i.test(t)?a():a(new Error("输入正确的电话"))};return{size:2097162,show:!1,minDate:new Date,currentDate:new Date,isVisible:!1,messsage:"",isShowLoading:"none",title:"添加",districtList:[],carTypeList:[],limitDaysList:[{value:"一月",label:"一月"}],mediaList:[{value:"汽油",label:"汽油"},{value:"柴油",label:"柴油"}],fileList:[],form:{district:"",carType:"",carNo:"",loadWeight:"",tel:"",media:"",picture:"",id:"",startTime:"",limitDays:""},rules:{district:[{required:!0,message:"请输入区域",trigger:"change"}],carType:[{required:!0,message:"请输入车型",trigger:"change"}],carNo:[{required:!0,message:"请输入车牌号",trigger:"change"}],loadWeight:[{required:!0,message:"请输入载重",trigger:"change"}],tel:[{required:!0,message:"请输入联系电话",trigger:"change"},{validator:e,trigger:"change"}],media:[{required:!0,message:"请选择介质",trigger:"change"}],startTime:[{required:!0,message:"请选择开始时间",trigger:"change"}],limitDays:[{required:!0,message:"请选择期限",trigger:"change"}]},mergeSpanArr:[],mergeSpanArrIndex:"",oddDistrictArr:[],evenDistrictArr:[],tableData:[]}},mounted:function(){this.queryCar()},methods:{showPopFn:function(){this.show=!0},changeFn:function(){this.changeDate=this.currentDate},confirmFn:function(){this.form.startTime=this.timeFormat(this.currentDate),this.show=!1},cancelFn:function(){this.show=!1},timeFormat:function(e){var t=e.getFullYear(),a=e.getMonth()+1,i=e.getDate(),r=e.getHours(),l=e.getMinutes(),o=e.getSeconds();return a>=1&&a<=9&&(a="0"+a),i>=0&&i<=9&&(i="0"+i),r>=1&&r<=9&&(r="0"+r),l>=0&&l<=9&&(l="0"+l),o>=0&&o<=9&&(o="0"+o),t+"-"+a+"-"+i+" "+r+":"+l+":"+o},beforeRead:function(e){return console.log(e),"image/jpeg"!==e.type&&"image/png"!==e.type&&"image/jpg"!==e.type?(this.$message.error("请上传jpeg、png、jpg图片"),!1):!(e.size>this.size)||(this.$message.error("图片大小不能超过2M"),!1)},afterRead:function(e){this.uploadImg(e)},uploadImg:function(e){var t=this;this.messsage="上传图片中",this.isShowLoading="block",l["a"].requestPost("upload",{file:e.content,fileName:Date.now()+"-"+e.file.name},"post").then((function(e){e=e.data,"200"==e.code?(console.log(e.url),t.form.picture=e.url,t.isShowLoading="none"):t.$message.error("上传图片错误")}))},queryCar:function(){var e=this;l["a"].request("car/queryCar").then((function(t){t=t.data,"200"==t.code?(e.tableData=t.data,e.setMergeArr(e.tableData),e.getDistrict(e.tableData)):e.$message.error("查询数据失败")}))},controlCar:function(){var e=this,t="";"添加"==this.title?t="addCar":"修改"==this.title&&(t="updateCar"),this.$refs["form"].validate((function(a){if(!a)return!1;e.requestCar(t,e.title)}))},requestCar:function(e,t){var a=this;this.messsage="请求中",this.isShowLoading="block",console.log(this.form),l["a"].requestPost("car/".concat(e),this.form,"post").then((function(e){e=e.data,a.isShowLoading="none","200"==e.code?(a.$message({message:"".concat(t,"数据成功"),type:"success"}),a.queryCar(),a.isVisible=!1):a.$message.error("查询数据失败")}))},openAddDialog:function(){var e=this;this.isVisible=!this.isVisible,this.form={district:"",carType:"",carNo:"",loadWeight:"",tel:"",media:"",picture:"",startTime:this.timeFormat(new Date),limitDays:"",id:""},this.title="添加",this.$nextTick((function(){e.$refs["form"].resetFields()}))},openUpdateDialog:function(e){var t=this;this.isVisible=!this.isVisible;var a=Object(o["a"])(e);this.title="修改",console.log(a),this.$nextTick((function(){t.$refs["form"].resetFields(),t.form=Object.assign({},t.form,a),t.fileList=[],t.fileList.push({url:"http://192.144.184.96:80/"+t.form.picture})}))},toggleDialog:function(){this.isVisible=!this.isVisible},deleteCar:function(e){var t=this;this.form.id=e.id,this.$confirm("你确定要删除该条记录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",showClose:!1}).then((function(){t.requestCar("deleteCar","删除")})).catch((function(){}))},getDistrict:function(e){var t=this,a=e.reduce((function(e,t){return e.includes(t.district)||e.push(t.district),e}),[]);a.forEach((function(e,a){a%2?t.oddDistrictArr.push(e):t.evenDistrictArr.push(e)}))},changeCss:function(e){var t=e.row;return this.oddDistrictArr.includes(t.district)?"background:"+n.a.trOddColor:this.evenDistrictArr.includes(t.district)?"background:"+n.a.trEvenColor:void 0},renderHeader:function(e,t){var a=t.column,i=a.label.split(",");return e("span",{class:"render_label"},[e("p",[i[0]]),e("p",{class:"small-font"},[i[1]])])},arraySpanMethod:function(e){var t=e.rowIndex,a=e.columnIndex;if(0===a){var i=this.mergeSpanArr[t],r=i>0?1:0;return{rowspan:i,colspan:r}}},setMergeArr:function(e){this.mergeSpanArr=[],this.mergeSpanArrIndex="";for(var t=0;t<e.length;t++)0===t?(this.mergeSpanArr.push(1),this.mergeSpanArrIndex=0):e[t].district===e[t-1].district?(this.mergeSpanArr[this.mergeSpanArrIndex]+=1,this.mergeSpanArr.push(0)):(this.mergeSpanArr.push(1),this.mergeSpanArrIndex=t)}}},d=c,m=(a("9eff"),a("2877")),u=Object(m["a"])(d,i,r,!1,null,null,null);t["default"]=u.exports},e247:function(e,t,a){var i=a("068d");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var r=a("499e").default;r("b3836a28",i,!0,{sourceMap:!1,shadowMode:!1})}}]);